<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Happy Birthday!</title>
<style>
  body {
    margin:0;
    padding:0;
    font-family:'Comic Sans MS', cursive, sans-serif;
    overflow:hidden;
    background: linear-gradient(135deg, #ff9a9e, #fad0c4);
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    height:100vh;
  }

  h1 { 
    color:white; 
    text-shadow:2px 2px 5px #000; 
    margin-bottom:20px; 
    text-align:center;
  }

  .cake-container {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .cake {
    width: 200px;
    height: 100px;
    background: #f5b7b1;
    border-radius: 0 0 30px 30px;
    position: relative;
    box-shadow:0 4px 6px rgba(0,0,0,0.3);
  }

  .candles {
    display:flex;
    justify-content: space-around;
    width:100%;
    position:absolute;
    top:-40px;
    left:0;
  }

  .candle {
    width:6px;
    height:35px;
    background:#fff;
    border-radius:2px;
    position:relative;
  }

  .flame {
    width:12px;
    height:18px;
    background: radial-gradient(circle, yellow 30%, orange 70%, transparent 100%);
    border-radius:50%;
    position:absolute;
    top:-20px;
    left:-3px;
    animation:flicker 0.2s infinite alternate;
  }

  @keyframes flicker {
    0% {transform: scale(1) translateY(0); opacity:0.9;}
    50% {transform: scale(1.1) translateY(-1px); opacity:1;}
    100% {transform: scale(0.95) translateY(1px); opacity:0.85;}
  }

  #message {
    display:none;
    font-size:1.5rem;
    color:#fff;
    margin-top:30px;
    text-align:center;
    animation:fadeIn 2s forwards;
    text-shadow:2px 2px 6px #000;
  }

  @keyframes fadeIn {
    from{opacity:0;}
    to{opacity:1;}
  }

  button {
    margin-top:20px;
    padding:10px 20px;
    border:none;
    border-radius:25px;
    background:#ff5e78;
    color:white;
    font-size:1rem;
    cursor:pointer;
    box-shadow:0 4px 8px rgba(0,0,0,0.2);
  }

  /* Confetti style */
  .confetti {
    position:absolute;
    width:10px;
    height:10px;
    background-color: white;
    opacity:0.8;
    top:0;
    left:50%;
    animation: fall 3s linear infinite;
  }

  @keyframes fall {
    0% { transform: translateY(0) rotate(0deg);}
    100% { transform: translateY(100vh) rotate(360deg);}
  }
</style>
</head>
<body>
<h1>ðŸŽ‚ Blow Out the Candles! ðŸŽ‚</h1>
<div class="cake-container">
  <div class="candles" id="candles"></div>
  <div class="cake"></div>
</div>
<button onclick="startBlow()">ðŸŽ¤ Blow Candles</button>
<div id="message">ðŸ’– Happy Birthday Baby, I Love You So Much ðŸ’–</div>

<script>
  // Generate 16 candles
  const candlesContainer = document.getElementById('candles');
  for(let i=0;i<16;i++){
    const candle=document.createElement('div');
    candle.classList.add('candle');
    const flame=document.createElement('div');
    flame.classList.add('flame');
    candle.appendChild(flame);
    candlesContainer.appendChild(candle);
  }

  function blowOutCandles(){
    const flames=document.querySelectorAll('.flame');
    flames.forEach(f=>f.style.display='none');
    document.getElementById('message').style.display='block';
    createConfetti();
  }

  function startBlow(){
    if(navigator.mediaDevices.getUserMedia){
      navigator.mediaDevices.getUserMedia({audio:true})
        .then(stream=>{
          const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
          const source = audioCtx.createMediaStreamSource(stream);
          const analyser = audioCtx.createAnalyser();
          source.connect(analyser);
          const data = new Uint8Array(analyser.fftSize);

          function detectBlow(){
            analyser.getByteTimeDomainData(data);
            let sum=0;
            for(let i=0;i<data.length;i++) sum+=Math.abs(data[i]-128);
            let volume=sum/data.length;
            if(volume>20){ // blow detected
              blowOutCandles();
              stream.getTracks().forEach(track=>track.stop());
              return;
            }
            requestAnimationFrame(detectBlow);
          }
          detectBlow();
        })
        .catch(err=>alert('Mic access needed to blow out candles.'));
    } else {
      alert('Mic not supported, tap blow multiple times.');
    }
  }

  // Confetti
  function createConfetti(){
    for(let i=0;i<50;i++){
      const conf = document.createElement('div');
      conf.classList.add('confetti');
      conf.style.left = Math.random()*100 + 'vw';
      conf.style.background = `hsl(${Math.random()*360},80%,70%)`;
      conf.style.animationDuration = 2+Math.random()*3+'s';
      document.body.appendChild(conf);
      setTimeout(()=> conf.remove(),5000);
    }
  }
</script>
</body>
</html>
